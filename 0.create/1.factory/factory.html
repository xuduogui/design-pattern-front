<!--
 * @Author: xuziyong
 * @Date: 2021-06-18 01:07:34
 * @LastEditors: xuziyong
 * @LastEditTime: 2021-06-20 02:49:49
 * @Description: TODO
-->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Singleton</title>
  <style>
    body {
      padding: 20px 50px;
    }

    .xzy-page-container {
      width: 1140px;
      padding: 0;
      margin: 0 auto;
    }

    .xzy-link-to {
      float: right;
    }

    .xzy-demo-block-item {
      border: 1px solid #eaeefb;
      background-color: #fafafa;
      margin-bottom: 10px;
      padding: 5px 10px;
    }
  </style>
</head>

<body>

  <div class="xzy-page-container">
    <h1>工厂方法模式(Factory Method Pattern)</h1>

    <h2>简述</h2>
    <p>
      简单工厂：工厂类管理产品类，产品类修改不影响工厂类，产品类新增影响工厂类；
      <br />
      工厂方法：工厂类不管理产品类，产品类修改不影响工厂类，产品类新增不影响工厂类；
      <br />
      抽象工厂: 产品等级不限于同一层级；
    </p>

    <h2>应用场景</h2>
    <ul>
      <li>...</li>
    </ul>

    <h2>概念级实践</h2>
    <div id="">

      <h3>工厂方法</h3>
      <div class="xzy-demo-block-item">
        <button id="factory-button1">工厂方法</button>
        <p>
          <span id="factory-text1"></span>
        </p>
        <pre>
          <code>
            // ==== 工厂方法 START ====

            function FactoryAbstract() {
              this.factoryCreate = () => new ProductAbstract();
            }

            function ProductAbstract() {
              this.productName = '';
              this.productMethod = function () {
                return this.productName
              }
            }

            function FactoryEntity() {
              this.factoryCreate = () => new ProductEntity();
            }
            FactoryAbstract.prototype = new FactoryAbstract();

            function ProductEntity() {
              this.productName = 'ProductEntityName';
            }
            ProductEntity.prototype = new ProductAbstract();

            function demo1Init() {
              const factoryEntity = new FactoryEntity()

              const entity = factoryEntity.factoryCreate()

              const text = entity.productMethod()

              printTextById(text, 'factory-text1')
            }
            document.getElementById('factory-button1').addEventListener('click', demo1Init)

            // ==== 工厂方法 END ====
          </code>
        </pre>
      </div>


      <h3>简单工厂</h3>
      <div class="xzy-demo-block-item">
        <button id="factory-button2">简单工厂</button>
        <p>
          <span id="factory-text2"></span>
          <span id="factory-text3"></span>
        </p>
        <pre>
          <code>

            // ==== 简单工厂 START ====
            const PRODUCT_TYPE = {
              ProductSimpleEntity1: 1,
              ProductSimpleEntity2: 2,
            }
            function FactorySimpleAbstract() {
              this.factoryCreate = productType => new ProductSimpleAbstract()
            }
            function ProductSimpleAbstract() {
              this.productName = ''
              this.productMethod = function () {
                return this.productName
              }
            }

            function FactorySimpleEntity() {
              this.factoryCreate = function (product) {
                switch (product) {
                  case PRODUCT_TYPE.ProductSimpleEntity1:
                    return new ProductSimpleEntity1()

                  case PRODUCT_TYPE.ProductSimpleEntity2:
                    return new ProductSimpleEntity2()
                
                  default:
                    break;
                }
              }
            }
            FactorySimpleEntity.prototype = new FactorySimpleAbstract()

            function ProductSimpleEntity1() {
              this.productName = 'ProductSimpleEntity1'
            }
            ProductSimpleEntity1.prototype = new ProductSimpleAbstract()

            function ProductSimpleEntity2() {
              this.productName = 'ProductSimpleEntity2'
            }
            ProductSimpleEntity2.prototype = new ProductSimpleAbstract()

            function demo2Init() {
              const factoryEntity = new FactorySimpleEntity()

              const entity1 = factoryEntity.factoryCreate(PRODUCT_TYPE.ProductSimpleEntity1)

              const entity2 = factoryEntity.factoryCreate(PRODUCT_TYPE.ProductSimpleEntity2)

              const text1 = entity1.productMethod()

              const text2 = entity2.productMethod()

              printTextById(text1, 'factory-text2')

              printTextById(text2, 'factory-text3')
            }
            document.getElementById('factory-button2').addEventListener('click', demo2Init)

            // ==== 简单工厂 END ====

          </code>
        </pre>
      </div>
    </div>

  </div>

</body>

<script>
  // ==== 工厂方法 START ====

  function FactoryAbstract() {
    this.factoryCreate = () => new ProductAbstract();
  }

  function ProductAbstract() {
    this.productName = '';
    this.productMethod = function () {
      return this.productName
    }
  }

  function FactoryEntity() {
    this.factoryCreate = () => new ProductEntity();
  }
  FactoryAbstract.prototype = new FactoryAbstract();

  function ProductEntity() {
    this.productName = 'ProductEntityName';
  }
  ProductEntity.prototype = new ProductAbstract();

  function demo1Init() {
    const factoryEntity = new FactoryEntity()

    const entity = factoryEntity.factoryCreate()

    const text = entity.productMethod()

    printTextById(text, 'factory-text1')
  }
  document.getElementById('factory-button1').addEventListener('click', demo1Init)

  // ==== 工厂方法 END ====


  // ==== 简单工厂 START ====
  const PRODUCT_TYPE = {
    ProductSimpleEntity1: 1,
    ProductSimpleEntity2: 2,
  }

  function FactorySimpleAbstract() {
    this.factoryCreate = productType => new ProductSimpleAbstract()
  }

  function ProductSimpleAbstract() {
    this.productName = ''
    this.productMethod = function () {
      return this.productName
    }
  }

  function FactorySimpleEntity() {
    this.factoryCreate = function (product) {
      switch (product) {
        case PRODUCT_TYPE.ProductSimpleEntity1:
          return new ProductSimpleEntity1()

        case PRODUCT_TYPE.ProductSimpleEntity2:
          return new ProductSimpleEntity2()

        default:
          break;
      }
    }
  }
  FactorySimpleEntity.prototype = new FactorySimpleAbstract()

  function ProductSimpleEntity1() {
    this.productName = 'ProductSimpleEntity1'
  }
  ProductSimpleEntity1.prototype = new ProductSimpleAbstract()

  function ProductSimpleEntity2() {
    this.productName = 'ProductSimpleEntity2'
  }
  ProductSimpleEntity2.prototype = new ProductSimpleAbstract()

  function demo2Init() {
    const factoryEntity = new FactorySimpleEntity()

    const entity1 = factoryEntity.factoryCreate(PRODUCT_TYPE.ProductSimpleEntity1)

    const entity2 = factoryEntity.factoryCreate(PRODUCT_TYPE.ProductSimpleEntity2)

    const text1 = entity1.productMethod()

    const text2 = entity2.productMethod()

    printTextById(text1, 'factory-text2')

    printTextById(text2, 'factory-text3')
  }
  document.getElementById('factory-button2').addEventListener('click', demo2Init)

  // ==== 简单工厂 END ====

  function printTextToDom(text, dom) {
    dom.innerText = text
  }

  function printTextByClassName(text, className) {
    document.getElementsByClassName(className).forEach(domItem => {
      domItem.innerText = text;
    })
  }

  function printTextById(text, id) {
    document.getElementById(id).innerText = text;
  }
</script>

</html>